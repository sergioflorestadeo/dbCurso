-- Crear base de datos dbCursos
CREATE DATABASE IF NOT EXISTS dbCurso
DEFAULT CHARACTER SET utf8;

-- Poner en uso
USE dbCURSO;

-- Crear la tabla PERSONA
CREATE TABLE PERSONA
(
     DNIPER CHAR(8),
     NOMPER VARCHAR(50),
     APEPER VARCHAR(80),
     FECNAPER DATE,
     CELPER CHAR(9),
     EMAPER VARCHAR(100),
     SEXPER CHAR(1),
     TIPPER CHAR(3),
     DISTPER VARCHAR(80),
     FECREGPER TIMESTAMP,
     PWSPER VARCHAR(20),
     CONSTRAINT  DNIPER_PK PRIMARY KEY (DNIPER)
);


-- Crear tabla DEPARTAMENTO
create table DEPARTAMENTO
(
    IDDEP int,
    NOMDEP varchar(50) NOT NULL,
    DNIPER char(8),
    SALJEFDEP DECIMAL(8,2),
    CONSTRAINT IDDEP_PK PRIMARY KEY(IDDEP)
);

-- Relacionar la tabla PERSONA con DEPARTAMENTO
ALTER TABLE DEPARTAMENTO
ADD CONSTRAINT PERSONA_DEPARTAMENTO_DNIPER
FOREIGN KEY (DNIPER) REFERENCES PERSONA (DNIPER);



-- Crear tabla HISTORICO
create table HISTORICO
(
    IDHIS int,
    DNIPER varchar(8) FK,
    FECFINHIST DATE  NOT NULL,
    TIPHIS  char(3),
    CONSTRAINT IDHID_PK PRIMARY KEY(IDHIS)
);

-- Relacionar la tabla PERSONA con HISTORICO
ALTER TABLE HISTORICO
ADD CONSTRAINT PERSONA_HISTORICO_DNIPER
FOREIGN KEY (DNIPER) REFERENCES PERSONA (DNIPER);


-- Crear tabla EMPLEADO
create table EMPLEADO
(
    IDEMP  int  PK,
    DNIPER char(8) FK,
    FECINGEMP DATE  NOT NULL,
    CARGEMP VARCHAR(40) NOT NULL,
    SALEMP DECIMAL(6,2) NOT NULL,
    CONSTRAINT IDEMP_PK PRIMARY KEY(IDEMP)
);

-- Relacionar la tabla PERSONA con EMPLEADO
ALTER TABLE EMPLEADO
ADD CONSTRAINT PERSONA_EMPLEADO_DNIPER
FOREIGN KEY (DNIPER) REFERENCES PERSONA (DNIPER);


-- Crear tabla INSCRIPCION
create table INSCRIPCION
(
    IDINSC int  PK,
    DNIPER char(8) FK,
    IDEMP int FK,
    IDOFER int FK,
    CONSTRAINT IDDEP_PK PRIMARY KEY(IDINSC)
);

-- Relacionar la tabla PERSONA con INSCRIPCION
ALTER TABLE INSCRIPCION
ADD CONSTRAINT PERSONA_INSCRPCION_DNIPER
FOREIGN KEY (DNIPER) REFERENCES PERSONA (DNIPER);


-- Crear tabla OFERTA
create table DEPARTAMENTO
(
    IDOFER int PK,
    CODCUR char(3),
    FECOFER DATE NOT NULL,
    FECINICCUROFER DATE NOT NULL,
    CONSTRAINT IDOFER_PK PRIMARY KEY(IDOFER)
);

-- Relacionar la tabla INSCRIPCION con OFERTA
ALTER TABLE OFERTA
ADD CONSTRAINT PERSONA_DEPARTAMENTO_DNIPER
FOREIGN KEY (IDINSC) REFERENCES PERSONA (IDINSC);


-- Relacionar la tabla OFERTA con EMPLEADO
ALTER TABLE OFERTA
ADD CONSTRAINT EMPLEADO_OFERTA_IDEMP
FOREIGN KEY (IDEMP) REFERENCES PERSONA (IDEMP);



-- Crear tabla CURSO
create table CURSO
(
    CODCUR CHAR (3) PK,
    DESCUR VARCHAR (30) NOT NULL,
    CATCUR char (3) NOT NULL,
    DURCUR int NOT NULL
    CONSTRAINT CODCUR_PK PRIMARY KEY(CODCUR)
);

-- Relacionar la tabla CURSO con OFERTA
ALTER TABLE OFERTA
ADD CONSTRAINT CURSO_OFERTA_IDOFER
PRIMARY KEY (IDOFER) REFERENCES CURSO (CODCUR);


